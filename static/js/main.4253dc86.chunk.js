(this["webpackJsonpmureder-on-the-hill"]=this["webpackJsonpmureder-on-the-hill"]||[]).push([[0],{10:function(e,t,o){e.exports=o(17)},15:function(e,t,o){},16:function(e,t,o){},17:function(e,t,o){"use strict";o.r(t);var n=o(0),i=o.n(n),r=o(9),a=o.n(r),c=(o(15),o(2)),l=o(7);o(16);function s(e,t){var o=e.x,n=e.y;switch(t){case"TOP":return{x:o,y:n-1};case"BOTTOM":return{x:o,y:n+1};case"RIGHT":return{x:o+1,y:n};case"LEFT":return{x:o-1,y:n}}}var u=o(1);var y=[];function h(){return y}function d(e){var t=e.item,o=.5*t.width,i=.5*t.height;return n.createElement("div",{title:t.name,style:{position:"absolute",zIndex:e.zIndex||50,height:t.height,width:t.width,backgroundColor:t.color||"grey",top:t.position.y-Q+.5*window.innerHeight-i,left:t.position.x-K+.5*window.innerWidth-o}})}function f(e){return{x:Math.floor((e.x+150)/300),y:Math.floor((e.y+150)/300)}}function v(e,t){return{x:e.position.x-300*t.x,y:e.position.y-300*t.y}}function w(e,t,o,n,i){if(!(t&&t.doors.has(n)))return!1;var r=s(o,n);if(!(null===e||void 0===e?void 0:e.hasCoord(r))){if(!i)return!1;null===e||void 0===e||e.fillCoord(r)}return!0}function x(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=150,i=.5*e.width,r=.5*e.height,a=.5*g,c=a-i,l=a-r,s=f(e.position),u=v(e,s),y=u.x,h=u.y,d=i+T-n,x=-1*d,m=r+T-n,p=-1*m,k=null===t||void 0===t?void 0:t.getCoord(s);if(y<=d){var O=w(t,k,s,"LEFT",o);if(Math.abs(h)>l||!O)return O&&Math.abs(h)<l+3?(h>0?e.position.y+=l-h:e.position.y-=l+h,e.velocity.y=0,!0):(e.position.x+=d-y,e.velocity.x=0,!0)}if(y>=x){var b=w(t,k,s,"RIGHT",o);if(Math.abs(h)>l||!b)return b&&Math.abs(h)<l+3?(h>0?e.position.y+=l-h:e.position.y-=l+h,e.velocity.y=0,!0):(e.position.x+=x-y,e.velocity.x=0,!0)}if(h<=m){var E=w(t,k,s,"TOP",o);if(Math.abs(y)>c||!E)return E&&Math.abs(y)<c+3?(y>0?e.position.x+=c-y:e.position.x-=c+y,e.velocity.x=0,!0):(e.position.y+=m-h,e.velocity.y=0,!0)}if(h>=p){var M=w(t,k,s,"BOTTOM",o);if(Math.abs(y)>c||!M)return M&&Math.abs(y)<c+3?(y>0?e.position.x+=c-y:e.position.x-=c+y,e.velocity.x=0,!0):(e.position.y+=p-h,e.velocity.y=0,!0)}return!1}var T=10,g=75,m=Math.max(window.innerWidth,window.innerHeight),p=Math.ceil(m/600);window.addEventListener("resize",(function(){m=Math.max(window.innerWidth,window.innerHeight),p=Math.ceil(m/600),console.log("Updated view dist",p)})),console.log("Initial view dist",p);var k=function(e){var t,o,n=e.tile,r=e.floor,a=e.overlayMode,c={x:n.x,y:n.y},l=f({x:K,y:Q});return t=c,o=l,Math.max(Math.abs(t.x-o.x),Math.abs(t.y-o.y))>p?null:i.a.createElement("div",{style:{zIndex:a?10:4,position:"absolute",height:300,width:300,top:300*n.y+.5*(window.innerHeight-300)-Q,left:300*n.x+.5*(window.innerWidth-300)-K,display:"flex",justifyContent:"center",alignItems:"center",color:"white",backgroundColor:a?void 0:"#663333"}},n.info.name,["TOP","RIGHT","BOTTOM","LEFT"].map((function(e){return i.a.createElement(b,{overlayMode:a,tile:n,floor:r,direction:e,hasDoor:n.doors.has(e),opened:n.hasNeighbor(r,e)})})))};function O(e,t){var o=0,n=0,i=0,r=0,a=t,c=t;switch(e){case"TOP":n="auto",a=void 0;break;case"BOTTOM":o="auto",a=void 0;break;case"RIGHT":i="auto",c=void 0;break;case"LEFT":r="auto",c=void 0}return{top:o,bottom:n,left:i,right:r,width:a,height:c}}var b=function(e){var t=e.direction,o=e.opened,n=e.hasDoor,r=e.tile,a=e.floor,l=e.overlayMode,u="TOP"===t||"BOTTOM"===t,y=i.a.createElement("div",{style:{flex:"auto",backgroundColor:"#322",height:u?"100%":void 0,width:u?void 0:"100%"}});return i.a.createElement("div",{style:Object(c.a)(Object(c.a)({},O(t,l?3:T)),{},{position:"absolute",display:"flex",flexDirection:u?"row":"column",justifyContent:"center",alignItems:"center",overflow:"hidden"})},y,n?i.a.createElement("div",{style:{cursor:o?void 0:"pointer",height:g,width:g,backgroundColor:o?"":"grey"},onClick:o?void 0:function(){a.fillCoord(s(r.coord,t)),X()}}):null,y)},E=o(5),M=o(6),C=function(){function e(t){Object(E.a)(this,e),this.info=t,this.x=0,this.y=0,this.initialDoors=void 0,this.rotation=0;var o=t.doors;this.initialDoors=new Set(o)}return Object(M.a)(e,[{key:"canPlace",value:function(e,t){var o=this,n=!0;return e.forEach((function(e){o.doors.has(e)||(n=!1)})),t.forEach((function(e){o.doors.has(e)&&(n=!1)})),n}},{key:"copy",value:function(t){var o=new e(this.info);return t?o.rotate(t):o.rotate(this.rotation),o}},{key:"rotate",value:function(e){return this.rotation=e%4,this}},{key:"hasNeighbor",value:function(e,t){return e.hasCoord(s(this.coord,t))}},{key:"coord",get:function(){return{x:this.x,y:this.y}}},{key:"doors",get:function(){var e=this,t=new Set;return this.initialDoors.forEach((function(o){t.add(function(e,t){var o=["TOP","RIGHT","BOTTOM","LEFT"],n=o.indexOf(e);return o[(n+t)%o.length]}(o,e.rotation))})),t}}]),e}(),I=new C({name:"Fourway",doors:["TOP","LEFT","RIGHT","BOTTOM"]}),j=new C({name:"TeeWay",doors:["TOP","LEFT","RIGHT"]}),P=new C({name:"Straight",doors:["TOP","BOTTOM"]}),H=new C({name:"LTurn",doors:["TOP","RIGHT"]}),L=new C({name:"RTurn",doors:["TOP","LEFT"]}),R=new C({name:"DeadEnd",doors:["TOP"]});function F(e){return[e,e.copy(1),e.copy(2),e.copy(3)]}function B(e){return[e,e.copy(1)]}var A=[].concat(Object(u.a)(B(I)),Object(u.a)(B(P)),Object(u.a)(F(j)),Object(u.a)(F(H)),Object(u.a)(F(L)),Object(u.a)(F(R)));function W(e,t){return"".concat(e,", ").concat(t)}var G=new(function(){function e(t){Object(E.a)(this,e),this.name=t,this.grid=new Map}return Object(M.a)(e,[{key:"getCoord",value:function(e){return this.getTile(e.x,e.y)}},{key:"getTile",value:function(e,t){return this.grid.get(W(e,t))}},{key:"hasCoord",value:function(e){return this.hasTile(e.x,e.y)}},{key:"hasTile",value:function(e,t){return this.grid.has(W(e,t))}},{key:"setCoord",value:function(e,t){this.setTile(e,t.x,t.y)}},{key:"setTile",value:function(e,t,o){if(this.hasTile(t,o))throw alert("Already had a tile there!"),"already had a tile!";e.x=t,e.y=o,this.grid.set(W(t,o),e)}},{key:"getValidSpotsForTiles",value:function(){}},{key:"fillCoord",value:function(e){this.fillTile(e.x,e.y)}},{key:"fillTile",value:function(e,t){var o=this,n=(["TOP","RIGHT","BOTTOM","LEFT"].map((function(n){return o.getCoord(s({x:e,y:t},n))})),new Set),i=new Set;["TOP","RIGHT","BOTTOM","LEFT"].forEach((function(r){var a=o.getCoord(s({x:e,y:t},r));a&&(a.doors.has(function(e){switch(e){case"TOP":return"BOTTOM";case"BOTTOM":return"TOP";case"RIGHT":return"LEFT";case"LEFT":return"RIGHT"}}(r))?n.add(r):i.add(r))}));var r=A.filter((function(e){return e.canPlace(n,i)}));if(!r)throw"wow we should really fix that!";var a=r[Math.floor(Math.random()*r.length)].copy();this.setTile(a,e,t)}},{key:"tiles",get:function(){return Array.from(this.grid,(function(e){var t=Object(l.a)(e,2);t[0];return t[1]}))}}]),e}())("Main Floor");G.setTile(I.copy(),0,0);var D,S;window.addEventListener("resize",(function(){D.width=window.innerWidth,D.height=window.innerHeight}));var z=T,N=10+300*p/z;console.log("ray length",N),window.addEventListener("resize",(function(){N=10+300*p/z,console.log("ray length",N)}));var U=Math.PI/100;function J(e,t,o){for(var n=0,i={x:e.x,y:e.y};!x({position:i,height:1,width:1,velocity:{x:0,y:0}},o)&&n<N;)i.x+=t.x,i.y+=t.y,n++;return i}function q(e){return{x:e.x-K+.5*window.innerWidth,y:e.y-Q+.5*window.innerHeight}}function V(e,t){if(!S){if(!(D=document.getElementById("fog")))return;if(D.width=window.innerWidth,D.height=window.innerHeight,!(S=D.getContext("2d")))return}S.clearRect(0,0,D.width,D.height);var o=function(e,t){for(var o=[],n=0;n<2*Math.PI;)o.push(J(e,{x:Math.cos(n)*z,y:Math.sin(n)*z},t)),n+=U;return o}(e.position,t);S.fillStyle="lightyellow",S.strokeStyle="1px lightyellow",S.beginPath();var n=q(e.position);S.moveTo(n.x,n.y),o.forEach((function(e){var t=q(e);S.lineTo(t.x,t.y)}));var i=q(o[0]);S.lineTo(i.x,i.y),S.stroke(),S.fill()}var Y={position:{x:0,y:0},height:30,width:15,color:"red",name:"You",velocity:{x:0,y:0},mass:140};function $(){return i.a.createElement(d,{item:Y,zIndex:51})}var K=0,Q=0,X=function(){},Z=!1,_={position:"absolute",zIndex:5,width:"100%",height:"100%",top:0,right:0,bottom:0,left:0};var ee=!1,te=!1,oe=!1,ne=!1,ie=!1;document.addEventListener("keydown",(function(e){"m"!==e.key&&"M"!==e.key||(ie||(Z=!Z),ie=!0),"a"!==e.key&&"A"!==e.key&&"ArrowLeft"!==e.key||(ee=!0,oe=!1),"d"!==e.key&&"D"!==e.key&&"ArrowRight"!==e.key||(oe=!0,ee=!1),"w"!==e.key&&"W"!==e.key&&"ArrowUp"!==e.key||(te=!0,ne=!1),"s"!==e.key&&"S"!==e.key&&"ArrowDown"!==e.key||(ne=!0,te=!1)})),document.addEventListener("keyup",(function(e){"a"!==e.key&&"A"!==e.key&&"ArrowLeft"!==e.key||(ee=!1),"d"!==e.key&&"D"!==e.key&&"ArrowRight"!==e.key||(oe=!1),"w"!==e.key&&"W"!==e.key&&"ArrowUp"!==e.key||(te=!1),"s"!==e.key&&"S"!==e.key&&"ArrowDown"!==e.key||(ne=!1),"m"!==e.key&&"M"!==e.key||(ie=!1)}));!function e(){var t;Z?(ee&&(K-=7),oe&&(K+=7),te&&(Q-=7),ne&&(Q+=7)):(Y.velocity=Y.velocity||{x:0,y:0},ee&&Y.velocity.x>-2&&(Y.velocity.x-=.3),oe&&Y.velocity.x<2&&(Y.velocity.x+=.3),te&&Y.velocity.y>-2&&(Y.velocity.y-=.3),ne&&Y.velocity.y<2&&(Y.velocity.y+=.3)),t=[Y],[].concat(Object(u.a)(t),Object(u.a)(h())).forEach((function(e,t){e.velocity.x&&(e.position.x+=e.velocity.x),e.velocity.y&&(e.position.y+=e.velocity.y)})),x(Y,G,!0),function(e){[].concat(Object(u.a)(e),Object(u.a)(h())).forEach((function(e){e.velocity&&(e.velocity.x&&(e.velocity.x*=.9,Math.abs(e.velocity.x)<.1&&(e.velocity.x=0)),e.velocity.y&&(e.velocity.y*=.9,Math.abs(e.velocity.y)<.1&&(e.velocity.y=0)))}))}([Y]),Z||(K=Y.position.x,Q=Y.position.y),V(Y,G),X(),requestAnimationFrame((function(){return e()}))}();var re=function(){var e=i.a.useState(0),t=Object(l.a)(e,2)[1],o=i.a.useCallback((function(){t(Math.random())}),[t]);return i.a.useEffect((function(){X=o}),[o]),i.a.createElement("div",{className:"App",style:{overflow:"hidden"}},Z?i.a.createElement("div",{style:{zIndex:100,bottom:0,padding:20,position:"absolute",left:0,right:0}},i.a.createElement("div",{style:{color:"white"}},"Map"),i.a.createElement("button",{onClick:function(){Q-=100,o()}},"UP!"),i.a.createElement("button",{onClick:function(){Q+=100,o()}},"DOWN!"),i.a.createElement("button",{onClick:function(){K-=100,o()}},"LEFT!"),i.a.createElement("button",{onClick:function(){K+=100,o()}},"RIGHT!"),i.a.createElement("button",{onClick:function(){K=0,Q=0,o()}},"CENTER!")):null,i.a.createElement($,null),i.a.createElement("div",null,i.a.createElement("canvas",{id:"fog",width:window.innerWidth,height:window.innerHeight,style:Object(c.a)(Object(c.a)({},_),{},{opacity:.2,filter:"blur(5px)"})}),i.a.createElement("div",{id:"gamefloor",style:{mixBlendMode:"normal"}},G.tiles.map((function(e){return i.a.createElement(k,{overlayMode:Z,floor:G,tile:e,key:W(e.x,e.y)})})),h().map((function(e){return i.a.createElement(d,{item:e})})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.4253dc86.chunk.js.map